## 4.1 存储系统概述

### 4.1.1 存储系统的层次结构

存储系统定义：两个或两个以上**速度、容量**和**价格**各不相同的存储器用**硬件**、**软件**或**软硬件结合**的方式连接起来的存储器称为一个存储系统。对应用程序员来说存储系统是透明的且相当于一个存储器，这个存储器的速度接近存储系统中速度最快的那个存储器、存储容量与容量最大的那个存储器相等、单位容量的价格接近最便宜的那个存储器；一般的计算机系统中主要有两种存储体系：

- **Cache存储体系**：由**Cache**和**主存储器**构成，主要目的是**提高**存储器的**速度**；（对系统程序员以上均透明）
- **虚拟存储体系**：由**主存储器**和**磁盘存储器**构成，主要目的是**扩大**存储器的**容量**；（对应用程序员透明）
  - 注：这里的透明不是指看得见可以操作，而是指不用管可以直接使用，就像开车不需要知道车启动的原理，车对驾驶员是透明的

### 4.1.2 存储系统分类

- 按存储介质：半导体存储器（固态硬盘，DRAM）；磁介质存储器（磁盘、磁带）；光存储器（光盘）；
- 按用途：主存储器（主存，DRAM）；高速缓冲存储器（Cache，DRAM）；控制存储器（CM，ROM）；外存（磁盘、光盘...）；
- 按易失性：易失（RAM）；非易失（ROM、磁盘、光盘...）；
- 按存取方式：随机存取（RAM）；顺序（串行）访问（SAM、DAM）；
- 按是否可读写：读写存储器；只读存储器（ROM）

### 4.1.3 存储器的性能指标

容量、速度、可靠性、功耗、价格、体积 ...



## 4.2 内存储器

内存储器，一般指计算机内部的存储器，比如寄存器、Cache、主存储器、ROM；

### 4.2.1 随机读写存储器

#### 一、内部结构

- 内部译码结构

![image-20230914182019079](img\image-20230914182019079.png)

- 单元电路

  RAM和分为SRAM（static RAM）和DRAM（Dynamic RAM），SRAM中一个存储单元由六个晶体管构成（同行/列共有的晶体管不计入），DRAM中一个存储单元通常只有一个晶体管和一个电容。

  晶体管，有三条接入线，单独在一侧的为栅极，输入的为源极，输出的为漏极。当栅极为高电平时，源极和漏极接通（饱和态），栅极为低电平时，源极和漏极断开（截止态）

![image-20230916070051317](img\image-20230916070051317.png)

- SRAM的原理：

  - 在理想状态下，通电后，a、b两点同时有电流、电流同时接到T1、T2的栅极，T1、T2同时达到高电平，导致a、b同时接地，a和b同时为低电平，但在实际状况下这种情况是不可能发生的，T1、T2不可能同时达到高电平。当T1先达到高电平后，导致a接地，b为高电平

  - 改写（以a为1改为a为0为例）:

    I/O线接低电平，I/O非接高电平，列选线Y和行选线X需同时有效，这样T5、T6、T7、T8都处于导通的状态，相当于a接低电平、b接高电平，a中原本的电平逐渐降低、b中的电平逐渐升高，当a中的电平变为低电平时，T2处于截止态，b不再接地且由于b中电平不断升高到达高电平后，即使X、Y不再有效，a点仍是接地

#### 二、主存储器的组成及接口

- 单片存储器芯片的连接	

  ![image-20230922152716848](img\image-20230922152716848.png)

- 内存的字扩展、位扩展（一般以SRAM为例，DRAM涉及到刷新连线比较复杂）

  - 利用 8K X 8bit 的SRAM，构成 32KB 内存

    <img src="img\image-20230922153733986.png" alt="image-20230922153733986" style="zoom: 33%;" />

  - 利用 2K X 4bit 的SRAM，构成 2K X 8bit 的内存

    <img src="img\image-20230922154415413.png" alt="image-20230922154415413" style="zoom:33%;" />

### 4.2.2 只读存储器

<img src="img\image-20230922160541543.png" alt="image-20230922160541543" style="zoom:50%;" />

### 4.2.3 动态随机访问存储器

特点：

- DRAM的地址分为行地址和列地址，分开进行传送，因此对于相同个数的存储单元，DRAM的地址线是SRAM的地址线的一半
- 一般以行为单位进行刷新，刷新方式一般有集中式、分散式（分布式）、异步式）

![image-20230922163227097](img\image-20230922163227097.png)

### 4.2.3 同步动态存储器SDRAM

### 4.2.4 其它存储器

- 多端口存储器（以双端口为例）

  - 读/写操作：对不同的存储单元允许同时读、同时写；对同一存储单元允许同时读、一个端口写，另一个端口读，不允许同时写
  - 竞争的消除：一边只写、一边只读；信号灯
  - 应用：
    - CPU和DMA设备之间、CPU和IO处理机之间
    - 多机系统：多个CPU之间
    - CPU内部：多总线结构，通用寄存器为运算器的两个输入端同时提供操作数
    - 多级存储体系：Cache采用双端口存储器

- 多体交叉存储器（多模块存储器）

  并行主存系统：把主存储器分为多个存储体交叉或并行工作，在一个主存周期内能读写多个字

  ![image-20230922180420496](img\image-20230922180420496.png)

  <img src="img\image-20230922180532812.png" alt="image-20230922180532812" style="zoom:33%;" />

  多体交叉存储器提高存取速度的前提：连续访问的数据必须要存储在不同的存储体

- 相联存储器

  原理：按内容访问。把存储单元所存内容的某一部分作为检索项来检索该存储器，并将存储器中与该检索项符合的存储单元内容进行读出或写入。

  ![image-20230922182822502](img\image-20230922182822502.png)

